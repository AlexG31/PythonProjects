<!DOCTYPE html>
<!--[if IE 6]><html class="ie lt-ie8"><![endif]-->
<!--[if IE 7]><html class="ie lt-ie8"><![endif]-->
<!--[if IE 8]><html class="ie ie8"><![endif]-->
<!--[if IE 9]><html class="ie ie9"><![endif]-->
<!--[if !IE]><!--> <html> <!--<![endif]-->

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">
  <meta http-equiv="Cache-Control" content="no-siteapp" />
    <meta name="description"  content="本文希望达到以下目标:简要介绍Scarpy阅读官网入门文档并实现文档中的范例使用Scarpy优豆瓣爬虫的抓取制定下一步学习目标初学Scrapy,如有翻译不当,或者代码错误,请指出,非常感谢Scrapy简介Scrapy是一个...">
  <meta property="wb:webmaster" content="294ec9de89e7fadb" />
  <meta property="qc:admins" content="104102651453316562112116375" />
  <meta property="qc:admins" content="11635613706305617" />
  <meta property="qc:admins" content="1163561616621163056375" />
  <meta name="google-site-verification" content="cV4-qkUJZR6gmFeajx_UyPe47GW9vY6cnCrYtCHYNh4" />
  <meta name="google-site-verification" content="HF7lfF8YEGs1qtCE-kPml8Z469e2RHhGajy6JPVy5XI" />
  <meta http-equiv="mobile-agent" content="format=html5; url=http://www.jianshu.com/p/078ad2067419">
    <!--  Meta for Smart App Banner -->
  <meta name="apple-itunes-app" content="app-id=888237539, app-argument=jianshu://notes/415442">
  <!-- End -->

  <!--  Meta for Twitter Card -->
  <meta content="summary" property="twitter:card">
  <meta content="@jianshucom" property="twitter:site">
  <meta content="Python爬虫(六)--Scrapy框架学习" property="twitter:title">
  <meta content="本文希望达到以下目标:简要介绍Scarpy阅读官网入门文档并实现文档中的范例使用Scarpy优豆瓣爬虫的抓取制定下一步学习目标初学Scrapy,如有翻译不当,或者代码错误,请指出,非常感谢Scrapy简介Scrapy是一个..." property="twitter:description">
  <meta content="http://www.jianshu.com/p/078ad2067419" property="twitter:url">
  <!-- End -->

  <!--  Meta for OpenGraph -->
  <meta property="fb:app_id" content="865829053512461">
  <meta property="og:site_name" content="简书">
  <meta property="og:title" content="Python爬虫(六)--Scrapy框架学习">
  <meta property="og:type" content="article">
  <meta property="og:url" content="http://www.jianshu.com/p/078ad2067419">
  <meta property="og:description" content="本文希望达到以下目标:简要介绍Scarpy阅读官网入门文档并实现文档中的范例使用Scarpy优豆瓣爬虫的抓取制定下一步学习目标初学Scrapy,如有翻译不当,或者代码错误,请指出,非常感谢Scr...">

  <!-- End -->

  <!--  Meta for Facebook Applinks -->
  <meta property="al:ios:url" content="jianshu://notes/415442" />
  <meta property="al:ios:app_store_id" content="888237539" />
  <meta property="al:ios:app_name" content="简书" />

  <meta property="al:android:url" content="jianshu://notes/415442" />
  <meta property="al:android:package" content="com.jianshu.haruki" />
  <meta property="al:android:app_name" content="简书" />
  <!-- End -->

  <title>Python爬虫(六)--Scrapy框架学习 - 简书</title>
  <meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="NhszgEFCjpu2jY8houO+7I2RsGbz/AuXTj976EdkTm5g+NztwbDubYx4g58qbmMUBdYiJ3zq+WTeuWdswkqLHA==" />
  <!--[if lte IE 8]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <link rel="stylesheet" media="all" href="http://cdn0.jianshu.io/assets/base-238f8c63cbd10f22d8e9a83c04291235.css" />

    <link rel="stylesheet" media="all" href="http://cdn0.jianshu.io/assets/reading-note-8d86b6cb191f7e4c6a703faf728a4263.css" />
  <link rel="stylesheet" media="all" href="http://cdn0.jianshu.io/assets/base-read-mode-2400119c5a397547ddac185dfa1db236.css" />
  <script src="http://cdn0.jianshu.io/assets/modernizr-8310b02f56277a1101d09f83069a465d.js"></script>
  <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
  <!--[if IE 8]><link rel="stylesheet" media="all" href="http://cdn0.jianshu.io/assets/scaffolding/for_ie-c6182786e742ff7467a374a2af472828.css" /><![endif]-->
  <!--[if lt IE 9]><link rel="stylesheet" media="all" href="http://cdn0.jianshu.io/assets/scaffolding/for_ie-c6182786e742ff7467a374a2af472828.css" /><![endif]-->
  <link href="http://baijii-common.b0.upaiyun.com/icons/favicon.ico" rel="icon">
      <link rel="apple-touch-icon-precomposed" href="http://cdn0.jianshu.io/assets/apple-touch-icons/57-7597f1cff93b0f41cd16ca7641e477eb.png" sizes="57x57" />
      <link rel="apple-touch-icon-precomposed" href="http://cdn0.jianshu.io/assets/apple-touch-icons/72-e02c647005f01e2d24778ac8e7f9dc45.png" sizes="72x72" />
      <link rel="apple-touch-icon-precomposed" href="http://cdn0.jianshu.io/assets/apple-touch-icons/76-4788ffdcd445555b5b93bfb4d1f4747c.png" sizes="76x76" />
      <link rel="apple-touch-icon-precomposed" href="http://cdn0.jianshu.io/assets/apple-touch-icons/114-e89d888a7bce6222606e46082dcab634.png" sizes="114x114" />
      <link rel="apple-touch-icon-precomposed" href="http://cdn0.jianshu.io/assets/apple-touch-icons/120-c7cdad6dd50db5a93175a6e015d6dc08.png" sizes="120x120" />
      <link rel="apple-touch-icon-precomposed" href="http://cdn0.jianshu.io/assets/apple-touch-icons/152-21fa4ed7968f6503816524e90dcb3d91.png" sizes="152x152" />
  <script>
    var _czc = _czc || [];
    _czc.push(["_setAccount", "1253183112"]);
  </script>
</head>

<body class="post output zh cn reader-day-mode reader-font2" data-js-module="note-show" data-locale="zh-CN">
  
  <div class="navbar navbar-jianshu shrink">
  <div class="dropdown">
    <a class="dropdown-toggle logo" id="dLabel" role="button" data-toggle="dropdown" data-target="#" href="javascript:void(0)">
      简
    </a>
    <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
      <li><a href="/"><i class="fa fa-home"></i> 首页</a></li>
      <li><a href="/collections"><i class="fa fa-th"></i> 专题</a></li>
      <li><a href="/user_invitations"><i class="fa fa-money"></i> 发钱啦</a></li>
    </ul>
  </div>
</div>
<div class="navbar-user">
    <a class="login" data-signup-link="true" data-toggle="modal" href="/sign_up">
      <i class="fa fa-user"></i> 注册
</a>    <a class="login" data-signin-link="true" data-toggle="modal" href="/sign_in">
      <i class="fa fa-sign-in"></i> 登录
</a>    <a class="daytime set-view-mode pull-right" href="javascript:void(0)"><i class="fa fa-moon-o"></i></a>
</div>
<div class="navbar navbar-jianshu expanded">
  <div class="dropdown">
      <a class="active logo" role="button" data-original-title="个人主页" data-container="div.expanded" href="/">
        <b>简</b><i class="fa fa-home"></i><span class="title">首页</span>
</a>      <a data-toggle="tooltip" data-placement="right" data-original-title="专题" data-container="div.expanded" href="/collections">
        <i class="fa fa-th"></i><span class="title">专题</span>
</a>    <a data-toggle="tooltip" data-placement="right" data-original-title="下载手机应用" data-container="body" href="/apps">
      <i class="fa fa-mobile"></i><span class="title">下载手机应用</span>
</a>  </div>
  <div class="nav-user">
      <a href='#view-mode-modal' data-toggle='modal'><i class="fa fa-font"></i><span class="title">显示模式</span></a>

      <a class="signin" data-signin-link="true" data-toggle="modal" data-placement="right" data-original-title="登录" data-container="div.expanded" href="/sign_in">
        <i class="fa fa-sign-in"></i><span class="title">登录</span>
</a>    </div>
  </div>

  
    <div class="fixed-btn">
    <a class="go-top hide-go-top" href="#"> <i class="fa fa-angle-up"></i></a>
    <a class="qrcode" data-target="#bottom-qrcode" data-toggle="modal" href="javascript:void(0)"><i class="fa fa-qrcode"></i></a>
    <a class="writer" href="/writer#/" data-toggle="tooltip" data-placement="left" title="写篇文章"><i class="fa fa-pencil"></i></a>
    <!-- qrcode modal -->
    <div id="bottom-qrcode" class="modal panel-modal hide fade" tabindex="-1" role="dialog" aria-hidden="true">
      <h4>下载简书移动应用</h4>
      <div class="panel-body"><img src="http://cdn0.jianshu.io/assets/app-page/download-app-qrcode-85008f146773a25ce86bcc4d7858af68.png" alt="Download app qrcode" /></div>
    </div>
  </div>


  <div id="show-note-container">
    

<div class="post-bg" id="flag">
  <div class="wrap-btn">
    <!-- Notebook and collections button upper left -->
      <div class="article-related pull-left">
          <a class="collection-menu-btn" data-toggle="modal" data-target="#collection-menu" href="javascript:void(null);">
            <i class="fa fa-th"></i>
</a>          <a class="notebooks-menu-btn" data-toggle="modal" data-target="#notebooks-menu" href="javascript:void(null);"><i class="fa fa-list-ul"></i></a>
        <div class="related-avatar-group activities"></div>
      </div>
    <!-- ******* -->

      <a class="login" data-signup-link="true" data-toggle="modal" href="/sign_up">
    <i class="fa fa-user"></i> 注册
</a>  <a class="login" data-signin-link="true" data-toggle="modal" href="/sign_in">
    <i class="fa fa-sign-in"></i> 登录
</a>

    <!-- Buttons upper right -->
    <!-- ******* -->
  </div>

  <div class="container">
    <!-- Article activities for width under 768px -->
    <div class="related-avatar-group activities"></div>
      <div class="article">
        <div class="preview">
          <div class="author-info">
              <div class="btn btn-small btn-success follow">
    <a data-signin-link="true" data-toggle="modal" href="/sign_in"><i class="fa fa-plus"></i>  <span>添加关注</span></a>
  </div>

            <a class="avatar" href="/users/4ee453b72aff">
              <img thumbnail="90x90" quality="100" src="http://upload.jianshu.io/users/upload_avatars/57011/820d1eedd165.jpg?imageMogr/thumbnail/90x90/quality/100" alt="820d1eedd165" />
</a>            <span class="label">作者</span>
            <a class="author-name blue-link" href="/users/4ee453b72aff">
              <span>Andrew_liu</span>
</a>              <span data-toggle='tooltip' data-original-title='最后编辑于 2014.12.20 13:44'>2014.12.17 22:36*</span>
            <div>
              <span>写了65583字</span>，<span>被683人关注</span>，<span>获得了1008个喜欢</span>
            </div>
          </div>
          <h1 class="title">Python爬虫(六)--Scrapy框架学习</h1>
          <div class="meta-top">
            <span class="wordage"></span>
            <span class="views-count"></span>
            <span class="comments-count"></span>
            <span class="likes-count"></span>
          </div>

          <!-- Collection/Bookmark/Share for width under 768px -->
          <div class="article-share"></div>
          <!-- -->

          <div class="show-content"><p>本文希望达到以下目标:</p>
<ol>
<li>简要介绍Scarpy</li>
<li>阅读官网入门文档并实现文档中的范例</li>
<li>使用Scarpy优豆瓣爬虫的抓取</li>
<li>制定下一步学习目标</li>
</ol>
<blockquote><p>初学<code>Scrapy</code>, 如有翻译不当, 或者代码错误, 请指出, 非常感谢</p></blockquote>
<h1>1. Scrapy简介</h1>
<hr>
<blockquote><p>Scrapy是一个为了爬取网站数据，提取结构性数据而编写的应用框架。 可以应用在包括数据挖掘，信息处理或存储历史数据等一系列的程序中。<br>其最初是为了页面抓取 (更确切来说, 网络抓取 )所设计的， 也可以应用在获取API所返回的数据(例如 Amazon Associates Web Services ) 或者通用的网络爬虫。Scrapy用途广泛，可以用于数据挖掘、监测和自动化测试</p></blockquote>
<p><code>Scrapy</code> 使用了 <code>Twisted</code>异步网络库来处理网络通讯。整体架构大致如下</p>
<div class="image-package">
<img src="http://newtonblogimg.qiniudn.com/Scrapy%20Architecture.png" alt="Scrapy"><br><div class="image-caption">Scrapy</div>
</div>
<p>Scrapy主要包括了以下组件：</p>
<ul>
<li>引擎(Scrapy): 用来处理整个系统的数据流处理, 触发事务(框架核心)</li>
<li>调度器(Scheduler): 用来接受引擎发过来的请求, 压入队列中, 并在引擎再次请求的时候返回. 可以想像成一个URL（抓取网页的网址或者说是链接）的优先队列, 由它来决定下一个要抓取的网址是什么, 同时去除重复的网址</li>
<li>下载器(Downloader): 用于下载网页内容, 并将网页内容返回给蜘蛛(Scrapy下载器是建立在twisted这个高效的异步模型上的)</li>
<li>爬虫(Spiders): 爬虫是主要干活的, 用于从特定的网页中提取自己需要的信息, 即所谓的实体(Item)。用户也可以从中提取出链接,让Scrapy继续抓取下一个页面</li>
<li>项目管道(Pipeline): 负责处理爬虫从网页中抽取的实体，主要的功能是持久化实体、验证实体的有效性、清除不需要的信息。当页面被爬虫解析后，将被发送到项目管道，并经过几个特定的次序处理数据。</li>
<li>下载器中间件(Downloader Middlewares): 位于Scrapy引擎和下载器之间的框架，主要是处理Scrapy引擎与下载器之间的请求及响应。</li>
<li>爬虫中间件(Spider Middlewares): 介于Scrapy引擎和爬虫之间的框架，主要工作是处理蜘蛛的响应输入和请求输出。</li>
<li>调度中间件(Scheduler Middewares): 介于Scrapy引擎和调度之间的中间件，从Scrapy引擎发送到调度的请求和响应。</li>
</ul>
<p><strong>Scrapy运行流程大概如下：</strong></p>
<ol>
<li>首先，引擎从调度器中取出一个链接(URL)用于接下来的抓取</li>
<li>引擎把URL封装成一个请求(Request)传给下载器，下载器把资源下载下来，并封装成应答包(Response)</li>
<li>然后，爬虫解析Response</li>
<li>若是解析出实体（Item）,则交给实体管道进行进一步的处理。</li>
<li>若是解析出的是链接（URL）,则把URL交给Scheduler等待抓取</li>
</ol>
<h1>2. 安装Scrapy</h1>
<hr>
<p>使用以下命令:</p>
<pre><code>sudo pip install virtualenv  #安装虚拟环境工具
virtualenv ENV  #创建一个虚拟环境目录
source ./ENV/bin/active  #激活虚拟环境
pip install Scrapy
#验证是否安装成功
pip list
#输出如下
cffi (0.8.6)
cryptography (0.6.1)
cssselect (0.9.1)
lxml (3.4.1)
pip (1.5.6)
pycparser (2.10)
pyOpenSSL (0.14)
queuelib (1.2.2)
Scrapy (0.24.4)
setuptools (3.6)
six (1.8.0)
Twisted (14.0.2)
w3lib (1.10.0)
wsgiref (0.1.2)
zope.interface (4.1.1)</code></pre>
<p><a href="http://andrewliu.tk/2014/12/08/Virtualenv%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/" target="_blank">更多虚拟环境的操作可以查看我的博文</a></p>
<h1>3. Scrapy Tutorial</h1>
<hr>
<p>在抓取之前, 你需要新建一个<code>Scrapy</code>工程. 进入一个你想用来保存代码的目录，然后执行：</p>
<pre><code>$ scrapy startproject tutorial</code></pre>
<p>这个命令会在当前目录下创建一个新目录 tutorial, 它的结构如下: </p>
<pre><code>.
├── scrapy.cfg
└── tutorial
    ├── __init__.py
    ├── items.py
    ├── pipelines.py
    ├── settings.py
    └── spiders
        └── __init__.py</code></pre>
<p>这些文件主要是：</p>
<ul>
<li>scrapy.cfg: 项目配置文件</li>
<li>tutorial/: 项目python模块, 之后您将在此加入代码</li>
<li>tutorial/items.py: 项目items文件</li>
<li>tutorial/pipelines.py: 项目管道文件</li>
<li>tutorial/settings.py: 项目配置文件</li>
<li>tutorial/spiders: 放置spider的目录</li>
</ul>
<h2>3.1. 定义Item</h2>
<p>Items是将要装载抓取的数据的容器，它工作方式像 python 里面的字典，但它提供更多的保护，比如对未定义的字段填充以防止拼写错误</p>
<p>通过创建<code>scrapy.Item类</code>, 并且定义类型为 <code>scrapy.Field</code> 的类属性来声明一个Item.<br>我们通过将需要的item模型化，来控制从 <code>dmoz.org</code> 获得的站点数据，比如我们要获得站点的名字，url 和网站描述，我们定义这三种属性的域。在 tutorial 目录下的 items.py 文件编辑</p>
<pre><code>from scrapy.item import Item, Field


class DmozItem(Item):
    # define the fields for your item here like:
    name = Field()
    description = Field()
    url = Field()</code></pre>
<h2>3.2. 编写Spider</h2>
<p>Spider 是用户编写的类, 用于从一个域（或域组）中抓取信息, 定义了用于下载的URL的初步列表, 如何跟踪链接，以及如何来解析这些网页的内容用于提取items。</p>
<p>要建立一个 Spider，继承 <code>scrapy.Spider</code> 基类，并确定三个主要的、强制的属性：</p>
<ul>
<li>name：爬虫的识别名，它必须是唯一的，在不同的爬虫中你必须定义不同的名字.</li>
<li>start_urls：包含了Spider在启动时进行爬取的url列表。因此，第一个被获取到的页面将是其中之一。后续的URL则从初始的URL获取到的数据中提取。我们可以利用正则表达式定义和过滤需要进行跟进的链接。</li>
<li>parse()：是spider的一个方法。被调用时，每个初始URL完成下载后生成的 Response 对象将会作为唯一的参数传递给该函数。该方法负责解析返回的数据(response data)，提取数据(生成item)以及生成需要进一步处理的URL的 Request 对象。<br>这个方法负责解析返回的数据、匹配抓取的数据(解析为 item )并跟踪更多的 URL。</li>
</ul>
<p>在 /tutorial/tutorial/spiders 目录下创建 <code>dmoz_spider.py</code></p>
<pre><code>import scrapy

class DmozSpider(scrapy.Spider):
    name = "dmoz"
    allowed_domains = ["dmoz.org"]
    start_urls = [
        "http://www.dmoz.org/Computers/Programming/Languages/Python/Books/",
        "http://www.dmoz.org/Computers/Programming/Languages/Python/Resources/"
    ]

    def parse(self, response):
        filename = response.url.split("/")[-2]
        with open(filename, 'wb') as f:
            f.write(response.body)</code></pre>
<h2>3.3. 爬取</h2>
<p>当前项目结构</p>
<pre><code>├── scrapy.cfg
└── tutorial
    ├── __init__.py
    ├── items.py
    ├── pipelines.py
    ├── settings.py
    └── spiders
        ├── __init__.py
        └── dmoz_spider.py</code></pre>
<p>到项目根目录, 然后运行命令:</p>
<pre><code>$ scrapy crawl dmoz</code></pre>
<p>运行结果:</p>
<pre><code>2014-12-15 09:30:59+0800 [scrapy] INFO: Scrapy 0.24.4 started (bot: tutorial)
2014-12-15 09:30:59+0800 [scrapy] INFO: Optional features available: ssl, http11
2014-12-15 09:30:59+0800 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'tutorial.spiders', 'SPIDER_MODULES': ['tutorial.spiders'], 'BOT_NAME': 'tutorial'}
2014-12-15 09:30:59+0800 [scrapy] INFO: Enabled extensions: LogStats, TelnetConsole, CloseSpider, WebService, CoreStats, SpiderState
2014-12-15 09:30:59+0800 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2014-12-15 09:30:59+0800 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2014-12-15 09:30:59+0800 [scrapy] INFO: Enabled item pipelines:
2014-12-15 09:30:59+0800 [dmoz] INFO: Spider opened
2014-12-15 09:30:59+0800 [dmoz] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2014-12-15 09:30:59+0800 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6023
2014-12-15 09:30:59+0800 [scrapy] DEBUG: Web service listening on 127.0.0.1:6080
2014-12-15 09:31:00+0800 [dmoz] DEBUG: Crawled (200) &lt;GET http://www.dmoz.org/Computers/Programming/Languages/Python/Resources/&gt; (referer: None)
2014-12-15 09:31:00+0800 [dmoz] DEBUG: Crawled (200) &lt;GET http://www.dmoz.org/Computers/Programming/Languages/Python/Books/&gt; (referer: None)
2014-12-15 09:31:00+0800 [dmoz] INFO: Closing spider (finished)
2014-12-15 09:31:00+0800 [dmoz] INFO: Dumping Scrapy stats:
    {'downloader/request_bytes': 516,
     'downloader/request_count': 2,
     'downloader/request_method_count/GET': 2,
     'downloader/response_bytes': 16338,
     'downloader/response_count': 2,
     'downloader/response_status_count/200': 2,
     'finish_reason': 'finished',
     'finish_time': datetime.datetime(2014, 12, 15, 1, 31, 0, 666214),
     'log_count/DEBUG': 4,
     'log_count/INFO': 7,
     'response_received_count': 2,
     'scheduler/dequeued': 2,
     'scheduler/dequeued/memory': 2,
     'scheduler/enqueued': 2,
     'scheduler/enqueued/memory': 2,
     'start_time': datetime.datetime(2014, 12, 15, 1, 30, 59, 533207)}
2014-12-15 09:31:00+0800 [dmoz] INFO: Spider closed (finished)</code></pre>
<h2>3.4. 提取Items</h2>
<h3>3.4.1. 介绍Selector</h3>
<p>从网页中提取数据有很多方法。Scrapy使用了一种基于 <code>XPath</code> 或者 <code>CSS 表达式</code>机制： Scrapy Selectors </p>
<p>出XPath表达式的例子及对应的含义:</p>
<ul>
<li>
<code>/html/head/title</code>: 选择HTML文档中 <code>&lt;head&gt;</code> 标签内的 <code>&lt;title&gt;</code> 元素</li>
<li>
<code>/html/head/title/text()</code>: 选择 <code>&lt;title&gt;</code> 元素内的文本</li>
<li>
<code>//td</code>: 选择所有的 <code>&lt;td&gt;</code> 元素</li>
<li>
<code>//div[@class="mine"]</code>: 选择所有具有<code>class="mine"</code> 属性的 div 元素</li>
</ul>
<blockquote><p>等多强大的功能使用可以查看<a href="http://www.w3school.com.cn/xpath/" target="_blank">XPath tutorial</a></p></blockquote>
<p>为了方便使用 XPaths，Scrapy 提供 Selector 类， 有四种方法 :</p>
<ul>
<li>xpath()：返回selectors列表, 每一个selector表示一个xpath参数表达式选择的节点.</li>
<li>css() : 返回selectors列表, 每一个selector表示CSS参数表达式选择的节点</li>
<li>extract()：返回一个unicode字符串，该字符串为XPath选择器返回的数据</li>
<li>re()： 返回unicode字符串列表，字符串作为参数由正则表达式提取出来</li>
</ul>
<h3>3.4.2. 取出数据</h3>
<p>首先使用谷歌浏览器开发者工具, 查看网站源码, 来看自己需要取出的数据形式(这种方法比较麻烦), 更简单的方法是直接对感兴趣的东西右键<code>审查元素</code>, 可以直接查看网站源码</p>
<p>在查看网站源码后, 网站信息在第二个<code>&lt;ul&gt;</code>内</p>
<pre><code>&lt;ul class="directory-url" style="margin-left:0;"&gt;

 &lt;li&gt;&lt;a href="http://www.pearsonhighered.com/educator/academic/product/0,,0130260363,00%2Ben-USS_01DBC.html" class="listinglink"&gt;Core Python Programming&lt;/a&gt; 
- By Wesley J. Chun; Prentice Hall PTR, 2001, ISBN 0130260363. For experienced developers to improve extant skills; professional level examples. Starts by introducing syntax, objects, error handling, functions, classes, built-ins. [Prentice Hall]
&lt;div class="flag"&gt;&lt;a href="/public/flag?cat=Computers%2FProgramming%2FLanguages%2FPython%2FBooks&amp;url=http%3A%2F%2Fwww.pearsonhighered.com%2Feducator%2Facademic%2Fproduct%2F0%2C%2C0130260363%2C00%252Ben-USS_01DBC.html"&gt;&lt;img src="/img/flag.png" alt="[!]" title="report an issue with this listing"&gt;&lt;/a&gt;&lt;/div&gt;
&lt;/li&gt;
...省略部分...
&lt;/ul&gt;</code></pre>
<p>那么就可以通过一下方式进行提取数据</p>
<pre><code>#通过如下命令选择每个在网站中的 &lt;li&gt; 元素:
sel.xpath('//ul/li') 

#网站描述:
sel.xpath('//ul/li/text()').extract()

#网站标题:
sel.xpath('//ul/li/a/text()').extract()

#网站链接:
sel.xpath('//ul/li/a/@href').extract()

#如前所述，每个 xpath() 调用返回一个 selectors 列表，所以我们可以结合 xpath() 去挖掘更深的节点。我们将会用到这些特性，所以:

for sel in response.xpath('//ul/li')
    title = sel.xpath('a/text()').extract()
    link = sel.xpath('a/@href').extract()
    desc = sel.xpath('text()').extract()
    print title, link, desc</code></pre>
<p>在已有的爬虫文件中修改代码</p>
<pre><code>import scrapy

class DmozSpider(scrapy.Spider):
    name = "dmoz"
    allowed_domains = ["dmoz.org"]
    start_urls = [
        "http://www.dmoz.org/Computers/Programming/Languages/Python/Books/",
        "http://www.dmoz.org/Computers/Programming/Languages/Python/Resources/"
    ]

    def parse(self, response):
        for sel in response.xpath('//ul/li'):
            title = sel.xpath('a/text()').extract()
            link = sel.xpath('a/@href').extract()
            desc = sel.xpath('text()').extract()
            print title, link, desc</code></pre>
<h3>3.4.3. 使用item</h3>
<p><code>Item</code>对象是自定义的python字典,可以使用标准的字典语法来获取到其每个字段的值(字段即是我们之前用Field赋值的属性)</p>
<pre><code>&gt;&gt;&gt; item = DmozItem()
&gt;&gt;&gt; item['title'] = 'Example title'
&gt;&gt;&gt; item['title']
'Example title'</code></pre>
<p>一般来说，Spider将会将爬取到的数据以 Item 对象返回, 最后修改爬虫类，使用 Item 来保存数据，代码如下</p>
<pre><code>from scrapy.spider import Spider
from scrapy.selector import Selector
from tutorial.items import DmozItem 


class DmozSpider(Spider):
    name = "dmoz"
    allowed_domains = ["dmoz.org"]
    start_urls = [
        "http://www.dmoz.org/Computers/Programming/Languages/Python/Books/",
        "http://www.dmoz.org/Computers/Programming/Languages/Python/Resources/",
    ]

    def parse(self, response):
        sel = Selector(response)
        sites = sel.xpath('//ul[@class="directory-url"]/li')
        items = []

        for site in sites:
            item = DmozItem()
            item['name'] = site.xpath('a/text()').extract()
            item['url'] = site.xpath('a/@href').extract()
            item['description'] = site.xpath('text()').re('-\s[^\n]*\\r')
            items.append(item)
        return items</code></pre>
<h2>3.5. 使用Item Pipeline</h2>
<p>当Item在Spider中被收集之后，它将会被传递到Item Pipeline，一些组件会按照一定的顺序执行对Item的处理。<br>每个item pipeline组件(有时称之为<code>ItemPipeline</code>)是实现了简单方法的Python类。他们接收到Item并通过它执行一些行为，同时也决定此Item是否继续通过pipeline，或是被丢弃而不再进行处理。<br>以下是item pipeline的一些典型应用：</p>
<ul>
<li>清理HTML数据</li>
<li>验证爬取的数据(检查item包含某些字段)</li>
<li>查重(并丢弃)</li>
<li>将爬取结果保存，如保存到数据库、XML、JSON等文件中</li>
</ul>
<blockquote><p>　编写你自己的item pipeline很简单，每个item pipeline组件是一个独立的Python类，同时必须实现以下方法:</p></blockquote>
<pre><code>process_item(item, spider)  #每个item pipeline组件都需要调用该方法，这个方法必须返回一个 Item (或任何继承类)对象，或是抛出 DropItem异常，被丢弃的item将不会被之后的pipeline组件所处理。
#参数:
item: 由 parse 方法返回的 Item 对象(Item对象)
spider: 抓取到这个 Item 对象对应的爬虫对象(Spider对象)

open_spider(spider)  #当spider被开启时，这个方法被调用。
#参数: 
spider : (Spider object) – 被开启的spider
　　
close_spider(spider)  #当spider被关闭时，这个方法被调用，可以再爬虫关闭后进行相应的数据处理。
#参数: 
spider : (Spider object) – 被关闭的spider</code></pre>
<blockquote><p>为JSON文件编写一个items</p></blockquote>
<pre><code>from scrapy.exceptions import DropItem

class TutorialPipeline(object):

    # put all words in lowercase
    words_to_filter = ['politics', 'religion']

    def process_item(self, item, spider):
        for word in self.words_to_filter:
            if word in unicode(item['description']).lower():
                raise DropItem("Contains forbidden word: %s" % word)
        else:
            return item</code></pre>
<p>在 settings.py 中设置<code>ITEM_PIPELINES</code>激活item pipeline，其默认为[]</p>
<pre><code>ITEM_PIPELINES = {'tutorial.pipelines.FilterWordsPipeline': 1}</code></pre>
<h2>3.6. 存储数据</h2>
<p>使用下面的命令存储为<code>json</code>文件格式</p>
<pre><code>scrapy crawl dmoz -o items.json</code></pre>
<h1>4. Scarpy优化豆瓣爬虫的抓取</h1>
<hr>
<p>主要针对之间写过的豆瓣爬虫进行重构:</p>
<ul>
<li><a href="http://andrewliu.tk/2014/12/05/Python%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB-%E4%BA%8C-%E8%B1%86%E7%93%A3%E6%8A%93%E7%AB%99%E5%B0%8F%E8%AE%A1/" target="_blank">Python网络爬虫(二)--豆瓣抓站小计</a></li>
<li><a href="http://andrewliu.tk/2014/12/15/Python-%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%BB%AD-Queue/" target="_blank">豆瓣抓站重构第二版</a></li>
</ul>
<p>豆瓣有反爬虫机制, 只成功了一次后, 就被<code>baned</code>后显示403了, 下面说一下爬虫结构</p>
<p><a href="https://github.com/Andrew-liu/scrapy_example/tree/master/douban" target="_blank">完整的豆瓣爬虫代码链接</a></p>
<h2>4.1. Item</h2>
<pre><code>from scrapy.item import Item, Field


class DoubanItem(Item):
    # define the fields for your item here like:
    # name = scrapy.Field()
    name = Field()  #电影名称
    description = Field()  #电影描述
    url = Field()  #抓取的url</code></pre>
<h2>4.2. Spider主程序</h2>
<pre><code>#!/usr/bin/env python
# -*- coding:utf-8 -*-
"""
一个简单的Python 爬虫, 用于抓取豆瓣电影Top前250的电影的名称描述等

Anthor: Andrew Liu
Version: 0.0.3
Date: 2014-12-17
Language: Python2.7.8
Editor: Sublime Text2
Operate: 具体操作请看README.md介绍
"""

from scrapy.contrib.spiders import CrawlSpider, Rule
from scrapy.selector import Selector
from douban.items import DoubanItem
from scrapy.contrib.linkextractors.sgml import SgmlLinkExtractor

class DoubanSpider(CrawlSpider) :

    name = "douban" 
    allowed_domains = ["movie.douban.com"]
    start_urls = ["http://movie.douban.com/top250"]
    rules = (
        #将所有符合正则表达式的url加入到抓取列表中
        Rule(SgmlLinkExtractor(allow = (r'http://movie\.douban\.com/top250\?start=\d+&amp;filter=&amp;type=',))),
        #将所有符合正则表达式的url请求后下载网页代码, 形成response后调用自定义回调函数
        Rule(SgmlLinkExtractor(allow = (r'http://movie\.douban\.com/subject/\d+', )), callback = 'parse_page', follow = True),
        )

    def parse_page(self, response) :
        sel = Selector(response)
        item = DoubanItem()
        item['name'] = sel.xpath('//h1/span[@property="v:itemreviewed"]/text()').extract()
        item['description'] = sel.xpath('//div/span[@property="v:summary"]/text()').extract()
        item['url'] = response.url
        return item</code></pre>
<h2>4.3. 未来要解决的问题</h2>
<ul>
<li>头部伪装</li>
<li>表单提交</li>
<li>编码转换</li>
</ul>
<blockquote><p>豆瓣抓了一会儿, 还没等我兴奋就被禁掉了</p></blockquote>
<p><a href="http://doc.scrapy.org/en/latest/topics/practices.html#bans" target="_blank">ban</a></p>
<pre><code>...
2014-12-17 22:02:17+0800 [douban] DEBUG: Crawled (403) &lt;GET http://www.douban.com/misc/sorry?original-url=http%3A%2F%2Fmovie.douban.com%2Fsubject%2F2209573%2F%3Ffrom%3Dsubject-page&gt; (referer: http://movie.douban.com/subject/1849031/)
2014-12-17 22:02:17+0800 [douban] DEBUG: Ignoring response &lt;403 http://www.douban.com/misc/sorry?original-url=http%3A%2F%2Fmovie.douban.com%2Fsubject%2F2209573%2F%3Ffrom%3Dsubject-page&gt;: HTTP status code is not handled or not allowed
2014-12-17 22:02:17+0800 [douban] DEBUG: Crawled (403) &lt;GET http://www.douban.com/misc/sorry?original-url=http%3A%2F%2Fmovie.douban.com%2Fsubject%2F1849031%2Fcomments%3Fsort%3Dtime&gt; (referer: http://movie.douban.com/subject/1849031/)
...</code></pre>
<h1>5. 参考链接</h1>
<hr>
<ul>
<li><a href="http://doc.scrapy.org/en/0.24/index.html#section-basics" target="_blank">Basic concepts</a></li>
<li><a href="http://doc.scrapy.org/en/0.24/intro/overview.html#topics-whatelse" target="_blank"> What else? section in Scrapy at a glance </a></li>
<li><a href="http://doc.scrapy.org/en/0.24/topics/item-pipeline.html#topics-item-pipeline" target="_blank">Item Pipeline</a></li>
<li><a href="http://doc.scrapy.org/en/0.24/intro/tutorial.html" target="_blank">Scrapy Tutorial</a></li>
<li><a href="http://www.crummy.com/software/BeautifulSoup/bs3/documentation.zh.html" target="_blank">BeautifulSoup</a></li>
<li><a href="http://wwwsearch.sourceforge.net/mechanize/" target="_blank">mechanize</a></li>
<li><a href="http://scrapy.org/" target="_blank">scrapy</a></li>
<li><a href="http://doc.scrapy.org/en/0.24/topics/selectors.html#topics-selectors" target="_blank">Selectors documentation</a></li>
<li><a href="http://wsky.org/archives/191.html" target="_blank">scrapy 中文教程（爬cnbeta实例）</a></li>
<li><a href="http://www.dmoz.org/" target="_blank">dmoz</a></li>
</ul>
</div>
        </div>
      </div>

      <div class="visitor_edit">
        <!-- further readings -->
        <div id="further-readings" data-user-slug="" data-user-nickname="">
          <div id="further-reading-line" class="hide further-reading-line"></div>
          <ul id="further-readings-list" class="reading-list unstyled"></ul>
          <div id="further-reading-new" class="reading-edit">
              <a data-signin-link="true" data-toggle="modal" href="/sign_in">
                <i class="fa fa-plus-circle"></i> 推荐拓展阅读
</a>            <div id="further-reading-form"></div>
          </div>
        </div>
      </div>

      <!-- Reward / Support Author -->
        <div class="support-author">
          <p>如果觉得我的文章对您有用，请随意打赏。您的支持将鼓励我继续创作！</p>
            <a class="btn btn-pay" data-toggle="modal" href="#pay-modal">¥ 打赏支持</a>
          <div class="avatar-list"></div>
        </div>

      <!-- article meta bottom -->
      <div class="meta-bottom clearfix">
        <!--  Like Button -->
        <div class="like ">
            <div class="like-button">
              <a id="like-note" class="like-content" data-signin-link="true" data-toggle="modal" href="/sign_in">
                <i class="fa fa-heart-o"></i>  喜欢
</a></div>          <span id="likes-count" data-toggle="tooltip" data-placement="right" title="查看所有喜欢的用户">
            <i class="fa fa-spinner fa-pulse"></i>
</span>        </div>
        <!--  share group -->
        <div class="share-group pull-right">
          <a href="javascript:void((function(s,d,e,r,l,p,t,z,c){var%20f=&#39;http://v.t.sina.com.cn/share/share.php?appkey=1881139527&#39;,u=z||d.location,p=[&#39;&amp;url=&#39;,e(u),&#39;&amp;title=&#39;,e(t||d.title),&#39;&amp;source=&#39;,e(r),&#39;&amp;sourceUrl=&#39;,e(l),&#39;&amp;content=&#39;,c||&#39;gb2312&#39;,&#39;&amp;pic=&#39;,e(p||&#39;&#39;)].join(&#39;&#39;);function%20a(){if(!window.open([f,p].join(&#39;&#39;),&#39;mb&#39;,[&#39;toolbar=0,status=0,resizable=1,width=440,height=430,left=&#39;,(s.width-440)/2,&#39;,top=&#39;,(s.height-430)/2].join(&#39;&#39;)))u.href=[f,p].join(&#39;&#39;);};if(/Firefox/.test(navigator.userAgent))setTimeout(a,0);else%20a();})(screen,document,encodeURIComponent,&#39;&#39;,&#39;&#39;,&#39;http://cwb.assets.jianshu.io/notes/images/415442/weibo/image_f8a14db059cb.jpg&#39;, &#39;推荐 @永不停息的恐龙哥 的文章《Python爬虫(六)--Scrapy框架学习》（ 分享自 @简书 ）&#39;,&#39;http://www.jianshu.com/p/078ad2067419&#39;,&#39;页面编码gb2312|utf-8默认gb2312&#39;));" data-name="weibo">
            <i class="fa fa-weibo"></i><span>分享到微博</span>
          </a>
          <a data-toggle="modal" href="#share-weixin-modal" data-name="weixin">
            <i class="fa fa-weixin"></i><span>分享到微信</span>
          </a>
          <div class="more">
            <a href="javascript:void(0)" data-toggle="dropdown">更多分享<i class="fa fa-caret-down"></i></a>
            <ul class="dropdown-menu arrow-top">
                <li><a href="http://cwb.assets.jianshu.io/notes/images/415442/weibo/image_f8a14db059cb.jpg" target="_blank" data-name="changweibo"><i class="fa fa-arrow-circle-o-down"></i> 下载长微博图片</a></li>
                <li><a href="javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;http://share.v.t.qq.com/index.php?c=share&amp;a=index&amp;url=&#39;+e(&#39;http://www.jianshu.com/p/078ad2067419&#39;)+&#39;&amp;title=&#39;+e(&#39;推荐 Andrew_liu 的文章《Python爬虫(六)--Scrapy框架学习》（ 分享自 @jianshuio ）&#39;),x=function(){if(!window.open(r,&#39;tweibo&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=600,height=600&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();" data-name="tweibo"><img src="http://baijii-common.b0.upaiyun.com/social_icons/32x32/tweibo.png">分享到腾讯微博</a></li>
                <li><a href="javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=&#39;+e(&#39;http://www.jianshu.com/p/078ad2067419&#39;)+&#39;&amp;title=&#39;+e(&#39;推荐 Andrew_liu 的文章《Python爬虫(六)--Scrapy框架学习》&#39;),x=function(){if(!window.open(r,&#39;qzone&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=600,height=600&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();" data-name="qzone"><img src="http://baijii-common.b0.upaiyun.com/social_icons/32x32/qzone.png">分享到QQ空间</a></li>
                <li><a href="javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;https://twitter.com/share?url=&#39;+e(&#39;http://www.jianshu.com/p/078ad2067419&#39;)+&#39;&amp;text=&#39;+e(&#39;推荐 Andrew_liu 的文章《Python爬虫(六)--Scrapy框架学习》（ 分享自 @jianshucom ）&#39;)+&#39;&amp;related=&#39;+e(&#39;jianshucom&#39;),x=function(){if(!window.open(r,&#39;twitter&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=600,height=600&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();" data-name="twitter"><img src="http://baijii-common.b0.upaiyun.com/social_icons/32x32/twitter.png">分享到Twitter</a></li>
                <li><a href="javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;http://www.facebook.com/sharer.php?s=100&amp;p[url]=&#39;+e(&#39;http://www.jianshu.com/p/078ad2067419&#39;)+&#39;&amp;p[title]=&#39;+e(&#39;Python爬虫(六)--Scrapy框架学习 - 简书社&#39;)+&#39;&amp;p[summary]=&#39;+e(&#39;推荐 Andrew_liu 的文章《Python爬虫(六)--Scrapy框架学习》&#39;),x=function(){if(!window.open(r,&#39;facebook&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();" data-name="facebook"><img src="http://baijii-common.b0.upaiyun.com/social_icons/32x32/facebook.png">分享到Facebook</a></li>
                <li><a href="javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;https://plus.google.com/share?url=&#39;+e(&#39;http://www.jianshu.com/p/078ad2067419&#39;),x=function(){if(!window.open(r,&#39;google_plus&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();" data-name="google_plus"><img src="http://baijii-common.b0.upaiyun.com/social_icons/32x32/google_plus.png">分享到Google+</a></li>
                <li><a href="javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;http://widget.renren.com/dialog/share?resourceUrl=&#39;+e(&#39;http://www.jianshu.com/p/078ad2067419&#39;)+&#39;&amp;description=&#39;+e(&#39;推荐 Andrew_liu 的文章《Python爬虫(六)--Scrapy框架学习》&#39;)+&#39;&amp;title=&#39;+e(&#39;Python爬虫(六)--Scrapy框架学习&#39;),x=function(){if(!window.open(r,&#39;renren&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=600,height=600&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();" data-name="renren"><img src="http://baijii-common.b0.upaiyun.com/social_icons/32x32/renren.png">分享到人人网</a></li>
                <li><a href="javascript:void(function(){var d=document,e=encodeURIComponent,s1=window.getSelection,s2=d.getSelection,s3=d.selection,s=s1?s1():s2?s2():s3?s3.createRange().text:&#39;&#39;,r=&#39;http://www.douban.com/recommend/?url=&#39;+e(&#39;http://www.jianshu.com/p/078ad2067419&#39;)+&#39;&amp;title=&#39;+e(&#39;Python爬虫(六)--Scrapy框架学习&#39;)+&#39;&amp;sel=&#39;+e(s)+&#39;&amp;v=1&#39;,x=function(){if(!window.open(r,&#39;douban&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330&#39;))location.href=r+&#39;&amp;r=1&#39;};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})()" data-name="douban"><img src="http://baijii-common.b0.upaiyun.com/social_icons/32x32/douban.png">分享到豆瓣</a></li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Modals -->
      <div id="share-weixin-modal" class="modal hide fade share-weixin-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
  </div>
  <div class="modal-body">
    <h5>打开微信“扫一扫”，打开网页后点击屏幕右上角分享按钮</h5>
  </div>
</div>

      
      <div id="notebooks-menu" class="panel notebooks-menu arrow-top modal hide fade"><img class="loader-tiny" src="http://baijii-common.b0.upaiyun.com/loaders/tiny.gif" alt="Tiny" /></div>
      <div id="collection-menu" class="panel collection-menu arrow-top modal hide fade"><img class="loader-tiny" src="http://baijii-common.b0.upaiyun.com/loaders/tiny.gif" alt="Tiny" /></div>
      
      <div id="likes-modal" class="modal modal_new support_list-modal fullscreen hide fade" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h3>喜欢的用户</h3>
      </div>
      <div class="modal-body">
        <ul class="unstyled users">
          <img class="loader-tiny editor-loading" src="http://baijii-common.b0.upaiyun.com/loaders/tiny.gif" alt="Tiny" />
        </ul>
      </div>
    </div>
  </div>
</div>



    <!-- Comments -->
    <div id="comments" class="comment-list clearfix">
        <div class="comment-head clearfix">
          19条评论
          <span class="order">
            （
            <a data-order="asc" class="active" href="javascript:void(0)">按时间正序</a>·
            <a data-order="desc" href="javascript:void(0)">按时间倒序</a>·
            <a data-order="likes_count" href="javascript:void(0)">按喜欢排序</a>
            ）
          </span>
            <a class="goto-comment pull-right" data-signin-link="true" data-toggle="modal" href="/sign_in">
              <i class="fa fa-pencil"></i>添加新评论
</a>        </div>
        <div id="comment-list">
          <img class="loader-tiny" src="http://baijii-common.b0.upaiyun.com/loaders/tiny.gif" alt="Tiny" />
        </div>
          <p class="signout-comment">
    <a class="btn btn-info" data-signin-link="true" data-toggle="modal" href="/sign_in">
      登录后发表评论
</a>  </p>

    </div>
    <!-- -->

  </div>

  <script type='application/json' data-name='note'>
    {"id":415442,"abbr":"本文希望达到以下目标:简要介绍Scarpy阅读官网入门文档并实现文档中的范例使用Scarpy优豆瓣爬虫的抓取制定下一步学习目标初学Scrapy,如有翻译不当,或者代码错误,请指出,非常感谢Scrapy简介Scrapy是一个...","slug":"078ad2067419","url":"http://www.jianshu.com/p/078ad2067419","image_url":"http://cwb.assets.jianshu.io/notes/images/415442/weibo/image_f8a14db059cb.jpg","wordage":4245,"has_further_readings":false,"views_count":9428,"likes_count":44,"comments_count":19,"rewards_total_count":0}
  </script>

  <script type='application/json' data-name='uuid'>
    {"uuid":"b3e7a0a0-7d76-0133-3fe5-5254003881ca"}
  </script>

  <script type='application/json' data-name='author'>
    {"id":57011,"nickname":"Andrew_liu","slug":"4ee453b72aff","public_notes_count":38,"followers_count":683,"total_likes_count":1008,"is_current_user":false}
  </script>


    <div class="include-collection">
      <div class="content">
        <h5>被以下专题收入，发现更多相似内容：</h5>
        <ul id="all-collections" class="unstyled collections-list">
            <li>
              <a class="avatar" href="/collection/NEt52a"><img src="http://upload.jianshu.io/collections/images/16/computer_guy.jpg?imageMogr2/auto-orient/strip|imageView2/2/w/180" alt="180" /></a>              <div class="collections-info">
                <h5>
                  <a href="/collection/NEt52a">程序员</a>
                </h5>
                
  <div class="btn btn-success follow">
    <a data-signin-link="true" data-toggle="modal" href="/sign_in"><i class="fa fa-fw fa-plus"></i>  <span>添加关注</span></a>
    <span>42.3K</span>
  </div>

                <p class="description">简书程序员大本营

投稿须知：
1.本专题仅收录与程序有关的文章。
2.请在代码框里写代码，尽量保证可看性。</p>
                <p>
                  <a class="blue-link" href="/collection/NEt52a">3686篇文章</a> · 42318人关注
                </p>
              </div>
            </li>
            <li>
              <a class="avatar" href="/collection/f16b3d483ec2"><img src="http://upload.jianshu.io/collections/images/362/%E5%B9%B2-order.jpg?imageMogr2/auto-orient/strip|imageView2/2/w/180" alt="180" /></a>              <div class="collections-info">
                <h5>
                  <a href="/collection/f16b3d483ec2">干货</a>
                </h5>
                
  <div class="btn btn-success follow">
    <a data-signin-link="true" data-toggle="modal" href="/sign_in"><i class="fa fa-fw fa-plus"></i>  <span>添加关注</span></a>
    <span>16.4K</span>
  </div>

                <p class="description">欢迎投稿 将实用的知识共享</p>
                <p>
                  <a class="blue-link" href="/collection/f16b3d483ec2">2254篇文章</a> · 16445人关注
                </p>
              </div>
            </li>
            <li>
              <a class="avatar" href="/collection/0f5e015fc36c"><img src="http://upload.jianshu.io/collections/images/2150/3.png?imageMogr2/auto-orient/strip|imageView2/2/w/180" alt="180" /></a>              <div class="collections-info">
                <h5>
                  <a href="/collection/0f5e015fc36c">代码改变世界</a>
                </h5>
                
  <div class="btn btn-success follow">
    <a data-signin-link="true" data-toggle="modal" href="/sign_in"><i class="fa fa-fw fa-plus"></i>  <span>添加关注</span></a>
    <span>7.9K</span>
  </div>

                <p class="description">Write the Code, Change the World, 改变世界从编程开始, 收集编程相关的干货</p>
                <p>
                  <a class="blue-link" href="/collection/0f5e015fc36c">1149篇文章</a> · 7922人关注
                </p>
              </div>
            </li>
        </ul>
      </div>
    </div>

  <!-- Modal -->
    <div class="modal pay-modal text-center hide fade" id="pay-modal">
  <div class="modal-header clearfix">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
  </div>
  <form id="new_reward" class="new_reward" target="_blank" action="/notes/415442/rewards" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="Rkv8Gf2Dh5gBIjFWmyR8FtkXEuLfNLgD06nI7Emi9JEQqBN0fXHnbjvXPegTqaHuUVCAo1AiSvBDL9RozIwx4w==" />
    <div class="modal-body">
      <a href="/users/4ee453b72aff">
        <div class="avatar"><img thumbnail="90x90" quality="100" src="http://upload.jianshu.io/users/upload_avatars/57011/820d1eedd165.jpg?imageMogr/thumbnail/90x90/quality/100" alt="820d1eedd165" /></div>
</a>      <p><i class="fa fa-quote-left pull-left"></i>如果觉得我的文章对您有用，请随意打赏。您的支持将鼓励我继续创作！<i class="fa fa-quote-right pull-right"></i></p>
      <div class="main-inputs text-left">
        <div class="control-group">
          <label for="reward_amount">打赏金额</label><i class="fa fa-yen"></i>
          <input value="2.00" type="text" name="reward[amount_in_yuan]" id="reward_amount_in_yuan" />
        </div>
        <div class="control-group message">
          <textarea placeholder="给Ta留言" name="reward[message]" id="reward_message">
</textarea>
        </div>
      </div>
      <div class="choose-pay text-left">
        <h5>选择支付方式：</h5>
        <div>
          <label for="reward_channel_alipay">
            <input type="radio" value="alipay" checked="checked" name="reward[channel]" id="reward_channel_alipay" />
            <span class="alipay-bg"></span>
</label>
          
          <label for="reward_channel_wx_pub_qr">
            <input type="radio" value="wx_pub_qr" name="reward[channel]" id="reward_channel_wx_pub_qr" />
            微信支付
</label>        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button name="button" type="submit" class="btn btn-large btn-pay">立即支付</button>
    </div>
</form></div>

    <div class="modal success-pay text-center hide fade" id="success-pay">
  <div class="modal-header clearfix">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
  </div>
  <div class="modal-body">
    <h3><i class="icon-ok"></i>打赏成功</h3>
    <img src="http://cdn0.jianshu.io/assets/complete-pay-42a51932f3a745f4f2f7a81b04d6fb02.png" alt="Complete pay" />
  </div>
  <div class="modal-footer">
    
  </div>
</div>

</div>

  </div>
  <div id="flash" class="hide"></div>
  
  <div id="view-mode-modal" tabindex="-1" class="modal hide read-modal" aria-hidden="false" data-js-module='view-mode-modal'>
    <div class="btn-group change-background" data-toggle="buttons-radio">
      <a class="btn btn-daytime active" data-mode="day" href="javascript:void(null);">
        <i class="fa fa-sun-o"></i>
</a>      <a class="btn btn-nighttime " data-mode="night" href="javascript:void(null);">
        <i class="fa fa-moon-o"></i>
</a>    </div>
    <div class="btn-group change-font" data-toggle="buttons-radio">
      <a class="btn font " data-font="font1" href="javascript:void(null);">宋体</a>
      <a class="btn font hei active" data-font="font2" href="javascript:void(null);">黑体</a>
    </div>
    <div class="btn-group change-locale" data-toggle="buttons-radio">
      <a class="btn font active" data-locale="zh-CN" href="javascript:void(null);">简</a>
      <a class="btn font hei " data-locale="zh-TW" href="javascript:void(null);">繁</a>
    </div>
  </div>

  

  <script src="http://cdn0.jianshu.io/assets/base-c39afd602844983c1c2211b338c37b91.js"></script>
  
  <script src="http://cdn0.jianshu.io/assets/reading-base-c5eca841a1d41ace6c804ced6b033edd.js"></script>
  <script src="http://cdn0.jianshu.io/assets/reading/module_sets/note_show-9bc4dbe88efca06c25faf51bc32d5951.js"></script>
  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-35169517-1']);
  _gaq.push(['_setCustomVar', 2, 'User Type', 'Visitor', 1 ]);
  _gaq.push(['_trackPageview']);

  

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

<div style="display:none">
<script src="http://s95.cnzz.com/z_stat.php?id=1253183112&web_id=1253183112" language="JavaScript"></script>
</div>
</body>
</html>
